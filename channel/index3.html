<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="https://i.ytimg.com/...">
    <meta property="og:title" content="動画タイトル">
    <meta property="og:description" content="動画の説明">
    <meta name="theme-color" content="#ff0000">
    <title>YouTube チャンネルビューア</title>
</head>
<body>
    <div id="channel-info">
        チャンネル情報を取得中...
    </div>

    <script>
        const apiUrl = 'https://test-five-gules-98.vercel.app'; // Flask APIのURL
        const params = new URLSearchParams(window.location.search);
        const channelId = params.get('c'); // URLのクエリパラメータからチャンネルIDを取得
        const channelInfoDiv = document.getElementById('channel-info');

        if (channelId) {
            fetch(`${apiUrl}/channel/${channelId}`)
                .then(response => response.text())
                .then(data => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(data, 'text/html');

                    // 不要な <script> タグを削除
                    doc.querySelectorAll('script').forEach(script => {
                        if (!script.textContent.includes('ytInitialData') && !script.type.includes('application/ld+json')) {
                            script.remove();
                        }
                    });

                    // フィルタリング後のHTMLを適用
                    channelInfoDiv.innerHTML = doc.body.innerHTML;
                })
                .catch(error => {
                    channelInfoDiv.textContent = 'チャンネル情報の取得に失敗しました。';
                    console.error('チャンネル情報取得エラー:', error);
                });
        } else {
            channelInfoDiv.textContent = 'チャンネルIDがありません。URLを確認してください。';
        }
    </script>
</body>
</html>
