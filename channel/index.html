<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="channel-info"></title>
</head>
<body>
<form class="pure-form" action="/v/search" method="get">
     <fieldset>
          <input type="search" id="searchbox" autocomplete="on" autocorrect="on" autocapitalize="none" spellcheck="false" name="q" placeholder="検索" title="検索">
     </fieldset>
  </form>  
  
  <div id="channel-info">
    <!-- チャンネル情報を表示 -->
  </div>

  <div id="channel-videos">
    <!-- チャンネルの動画一覧 -->
  </div>

  <script>
    const API_KEY = 'AIzaSyCfLrK2FPzEZllvwhjmugZ8Bwvzp6GRVpU'; // APIキー
    const params = new URLSearchParams(window.location.search);
    const channelId = params.get('c'); // チャンネルIDを取得

    const channelInfoDiv = document.getElementById('channel-info');
    const channelVideosDiv = document.getElementById('channel-videos');

    if (channelId) {
      // チャンネル情報を取得
      fetch(`https://www.googleapis.com/youtube/v3/channels?id=${channelId}&part=snippet,statistics&key=${API_KEY}`)
        .then(response => response.json())
        .then(data => {
          if (data.items && data.items.length > 0) {
            const channel = data.items[0];
            const title = channel.snippet.title;
            const description = channel.snippet.description;
            const icon = channel.snippet.thumbnails.default.url;
            const subscriberCount = channel.statistics.subscriberCount;

            // チャンネル情報を表示
            channelInfoDiv.innerHTML = `
              <h2>${title}</h2>
              <img src="${icon}" alt="${title}" style="width:100px; height:100px; border-radius:50%;">
              <p>${description}</p>
              <p>登録者数: ${subscriberCount}</p>
            `;
          }
        })
        .catch(error => {
          channelInfoDiv.textContent = 'チャンネル情報の取得に失敗しました。';
          console.error('チャンネル情報取得エラー:', error);
        });

      // チャンネルの動画一覧を取得
      fetch(`https://www.googleapis.com/youtube/v3/search?channelId=${channelId}&part=snippet&type=video&maxResults=10&key=${API_KEY}`)
        .then(response => response.json())
        .then(data => {
          if (data.items && data.items.length > 0) {
            data.items.forEach(item => {
              const videoId = item.id.videoId;
              const title = item.snippet.title;
              const description = item.snippet.description;
              const thumbnail = item.snippet.thumbnails.default.url;

              // 動画情報を表示
              channelVideosDiv.innerHTML += `
                <div>
                  <h3><a href="/v/watch/?v=${videoId}">${title}</a></h3>
                  <p>${description}</p>
                  <img src="${thumbnail}" alt="${title}" style="width:120px; height:90px;">
                </div>
              `;
            });
          }
        })
        .catch(error => {
          channelVideosDiv.textContent = 'チャンネル動画の取得に失敗しました。';
          console.error('チャンネル動画取得エラー:', error);
        });
    } else {
      channelInfoDiv.textContent = 'チャンネルIDがありません。URLを確認してください。';
    }
  </script>
</body>
</html>
